<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

<style>
  /* General Modal Styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.5);
  }

  .modal-content {
    background-color: #fefefe;
    margin: 10% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 500px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    animation: fadeIn 0.3s;
  }

  /* Modal Header */
  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #ddd;
    padding-bottom: 10px;
  }

  .modal-header h2 {
    margin: 0;
    font-size: 24px;
    color: #333;
  }

  .closeBtn {
    color: #aaa;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    transition: color 0.2s;
  }

  .closeBtn:hover,
  .closeBtn:focus {
    color: #000;
  }

  /* Modal Body */
  .modal-body {
    margin: 15px 0;
  }

  .input-field {
    position: relative;
    margin-bottom: 15px;
  }

  .input-field input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
  }

  .input-field label {
    position: absolute;
    top: -14px;
    left: 10px;
    background-color: #fefefe;
    padding: 0 5px;
    font-size: 14px;
    color: #888;
  }

  .button {
    display: block;
    width: 100%;
    padding: 10px;
    background-color: #007bff;
    border: none;
    border-radius: 5px;
    color: #fff;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .button:hover {
    background-color: #0056b3;
  }

  /* Modal Footer */
  .modal-footer {
    border-top: 1px solid #ddd;
    padding-top: 10px;
    text-align: center;
  }

  .modal-footer a {
    color: #007bff;
    text-decoration: none;
    transition: color 0.2s;
  }

  .modal-footer a:hover {
    color: #0056b3;
  }

  /* Keyframes for Animation */
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  /* Responsive Design */
  @media screen and (max-width: 768px) {
    .modal-content {
      width: 90%;
    }
  }


  
  body {
    background-color: #ffffff;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2000 1500'%3E%3Cdefs%3E%3Crect stroke='%23ffffff' stroke-width='.5' width='1' height='1' id='s'/%3E%3Cpattern id='a' width='3' height='3' patternUnits='userSpaceOnUse' patternTransform='scale(50) translate(-980 -735)'%3E%3Cuse fill='%23fcfcfc' href='%23s' y='2'/%3E%3Cuse fill='%23fcfcfc' href='%23s' x='1' y='2'/%3E%3Cuse fill='%23fafafa' href='%23s' x='2' y='2'/%3E%3Cuse fill='%23fafafa' href='%23s'/%3E%3Cuse fill='%23f7f7f7' href='%23s' x='2'/%3E%3Cuse fill='%23f7f7f7' href='%23s' x='1' y='1'/%3E%3C/pattern%3E%3Cpattern id='b' width='7' height='11' patternUnits='userSpaceOnUse' patternTransform='scale(50) translate(-980 -735)'%3E%3Cg fill='%23f5f5f5'%3E%3Cuse href='%23s'/%3E%3Cuse href='%23s' y='5' /%3E%3Cuse href='%23s' x='1' y='10'/%3E%3Cuse href='%23s' x='2' y='1'/%3E%3Cuse href='%23s' x='2' y='4'/%3E%3Cuse href='%23s' x='3' y='8'/%3E%3Cuse href='%23s' x='4' y='3'/%3E%3Cuse href='%23s' x='4' y='7'/%3E%3Cuse href='%23s' x='5' y='2'/%3E%3Cuse href='%23s' x='5' y='6'/%3E%3Cuse href='%23s' x='6' y='9'/%3E%3C/g%3E%3C/pattern%3E%3Cpattern id='h' width='5' height='13' patternUnits='userSpaceOnUse' patternTransform='scale(50) translate(-980 -735)'%3E%3Cg fill='%23f5f5f5'%3E%3Cuse href='%23s' y='5'/%3E%3Cuse href='%23s' y='8'/%3E%3Cuse href='%23s' x='1' y='1'/%3E%3Cuse href='%23s' x='1' y='9'/%3E%3Cuse href='%23s' x='1' y='12'/%3E%3Cuse href='%23s' x='2'/%3E%3Cuse href='%23s' x='2' y='4'/%3E%3Cuse href='%23s' x='3' y='2'/%3E%3Cuse href='%23s' x='3' y='6'/%3E%3Cuse href='%23s' x='3' y='11'/%3E%3Cuse href='%23s' x='4' y='3'/%3E%3Cuse href='%23s' x='4' y='7'/%3E%3Cuse href='%23s' x='4' y='10'/%3E%3C/g%3E%3C/pattern%3E%3Cpattern id='c' width='17' height='13' patternUnits='userSpaceOnUse' patternTransform='scale(50) translate(-980 -735)'%3E%3Cg fill='%23f2f2f2'%3E%3Cuse href='%23s' y='11'/%3E%3Cuse href='%23s' x='2' y='9'/%3E%3Cuse href='%23s' x='5' y='12'/%3E%3Cuse href='%23s' x='9' y='4'/%3E%3Cuse href='%23s' x='12' y='1'/%3E%3Cuse href='%23s' x='16' y='6'/%3E%3C/g%3E%3C/pattern%3E%3Cpattern id='d' width='19' height='17' patternUnits='userSpaceOnUse' patternTransform='scale(50) translate(-980 -735)'%3E%3Cg fill='%23ffffff'%3E%3Cuse href='%23s' y='9'/%3E%3Cuse href='%23s' x='16' y='5'/%3E%3Cuse href='%23s' x='14' y='2'/%3E%3Cuse href='%23s' x='11' y='11'/%3E%3Cuse href='%23s' x='6' y='14'/%3E%3C/g%3E%3Cg fill='%23efefef'%3E%3Cuse href='%23s' x='3' y='13'/%3E%3Cuse href='%23s' x='9' y='7'/%3E%3Cuse href='%23s' x='13' y='10'/%3E%3Cuse href='%23s' x='15' y='4'/%3E%3Cuse href='%23s' x='18' y='1'/%3E%3C/g%3E%3C/pattern%3E%3Cpattern id='e' width='47' height='53' patternUnits='userSpaceOnUse' patternTransform='scale(50) translate(-980 -735)'%3E%3Cg fill='%23F60'%3E%3Cuse href='%23s' x='2' y='5'/%3E%3Cuse href='%23s' x='16' y='38'/%3E%3Cuse href='%23s' x='46' y='42'/%3E%3Cuse href='%23s' x='29' y='20'/%3E%3C/g%3E%3C/pattern%3E%3Cpattern id='f' width='59' height='71' patternUnits='userSpaceOnUse' patternTransform='scale(50) translate(-980 -735)'%3E%3Cg fill='%23F60'%3E%3Cuse href='%23s' x='33' y='13'/%3E%3Cuse href='%23s' x='27' y='54'/%3E%3Cuse href='%23s' x='55' y='55'/%3E%3C/g%3E%3C/pattern%3E%3Cpattern id='g' width='139' height='97' patternUnits='userSpaceOnUse' patternTransform='scale(50) translate(-980 -735)'%3E%3Cg fill='%23F60'%3E%3Cuse href='%23s' x='11' y='8'/%3E%3Cuse href='%23s' x='51' y='13'/%3E%3Cuse href='%23s' x='17' y='73'/%3E%3Cuse href='%23s' x='99' y='57'/%3E%3C/g%3E%3C/pattern%3E%3C/defs%3E%3Crect fill='url(%23a)' width='100%25' height='100%25'/%3E%3Crect fill='url(%23b)' width='100%25' height='100%25'/%3E%3Crect fill='url(%23h)' width='100%25' height='100%25'/%3E%3Crect fill='url(%23c)' width='100%25' height='100%25'/%3E%3Crect fill='url(%23d)' width='100%25' height='100%25'/%3E%3Crect fill='url(%23e)' width='100%25' height='100%25'/%3E%3Crect fill='url(%23f)' width='100%25' height='100%25'/%3E%3Crect fill='url(%23g)' width='100%25' height='100%25'/%3E%3C/svg%3E");
    background-attachment: fixed;
    background-size: cover;
  }

  * {
    margin: 0;
    padding: 0;
  }
  /* Flex container for book cards */
  .main-container {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    gap: 10px;
    padding: 10px;
    justify-content: space-evenly;
  }

  /* Style for individual book cards */
  .book-card {
    margin-top: 10px;
    border-radius: 10px;
    height: 500px;
    width: 240px;
    padding: 10px; /* Increased padding for better spacing */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Softer shadow for a cleaner look */
    background-color: #fff; /* White background for better readability */
  }

  /* Style for the image inside book card */
  .book-card img {
    max-width: 100%;
    height: 60%;
    border-radius: 10px; /* Rounded corners for images */
  }

  /* Title styling */
  .book-card h3 {
    text-align: center;
    margin: 10px 0; /* Margin for spacing */
    font-size: 20px;
  }

  /* Link inside the title */
  .book-card a {
    text-decoration: none;
    color: #333; /* Dark color for better readability */
  }

  /* Price number */
  .book-card .price-number {
    text-align: center;
    margin: 10px 0;
  }

  /* Button styling */
  .book-card button {
    background-color: orange;
    border: none;
    padding: 10px; /* Increased padding for better clickability */
    border-radius: 5px;
    cursor: pointer;
    color: #fff; /* White text color for contrast */
    font-weight: bold; /* Bold text for emphasis */
    transition: background-color 0.3s, color 0.3s, box-shadow 0.3s; /* Smooth transition */
  }

  /* Button hover state */
  .add-book-button:hover {
    background-color: white;
    color: orange;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); /* Slightly darker shadow on hover */
  }
  
  /* Center pagination controls */
  .pagination-controls {
      text-align: center;
      margin-top: 20px;
  }

  /* Style for section titles */
  .section-title {
      text-align: center;
      font-size: 24px;
      margin-bottom: 20px;
      color: #333;
      font-weight: bold;
  }

  .section-title {
    text-align: center;
    font-size: 1.5rem;
    color: #333;
    font-weight: bold;
    margin-top: 20px;
}

    </style>
</head>
<body>
    <header id="header-container"></header>
    <!-- <button id="fetchAuthorsButton">Fetch Authors Data</button> -->
    <!-- <main>
      <div class="main-container">
        <div class="book-card">
          <img src="http://books.google.com/books/content?id=4cs2AwEACAAJ&printsec=frontcover&img=1&zoom=1&source=gbs_api" alt="cover">
          <h3>
            <a href="http://books.google.com/books?id=4cs2AwEACAAJ&dq=subject:adventure+language:en&hl=&as_pt=BOOKS&cd=9&source=gbs_api">Red Rackham's Treasure</a>
          </h3>
          <p class="price-number">
            <b>Price: <span>190₪</span></b>
          </p>
          <button class="add-book-button" data-book-id="4cs2AwEACAAJ">Add book</button>
        </div>    
      </div>

      <div class="main-container">
        <div class="book-card">
          <img src="http://books.google.com/books/content?id=4cs2AwEACAAJ&printsec=frontcover&img=1&zoom=1&source=gbs_api" alt="cover">
          <h3>
            <a href="http://books.google.com/books?id=4cs2AwEACAAJ&dq=subject:adventure+language:en&hl=&as_pt=BOOKS&cd=9&source=gbs_api">Red Rackham's Treasure</a>
          </h3>
          <p class="price-number">
            <b>Price: <span>190₪</span></b>
          </p>
          <button class="add-book-button" data-book-id="4cs2AwEACAAJ">Add book</button>
        </div>    
      </div>
      
    </main> -->
    
    <main>
        <h2 class="section-title">Digital Books</h2>
        <div class="main-container" id="digital-books-container">
            <!-- Digital books will be loaded here -->
        </div>
        <div id="digital-pagination" class="pagination-controls"></div>
        
        <h2 class="section-title">Digital Books</h2>
        <div class="main-container" id="physical-books-container">
            <!-- Physical books will be loaded here -->
        </div>
        <div id="physical-pagination" class="pagination-controls"></div>
    </main>
    
    <script>
      $(document).ready(function() {
        let digitalPage = 1;
        let physicalPage = 1;
        const pageSize = 5;

        loadDigitalBooks(digitalPage, pageSize);
        loadPhysicalBooks(physicalPage, pageSize);
      });

      function loadDigitalBooks(pageNumber, pageSize) {
          fetchBooksFromDB(true, pageNumber, pageSize);
      }

      function loadPhysicalBooks(pageNumber, pageSize) {
          fetchBooksFromDB(false, pageNumber, pageSize);
      }

      // Function to render books in the container
      function renderBooks(books, container) {
          container.empty(); // Clear the container
  
          books.forEach(book => {
              let bookCard = `
              <div class="book-card">
                  <img src="${book.smallThumbnailUrl}" alt="cover">
                  <h3>
                      <a href="${book.infoLink}" target="_blank">${book.title}</a>
                  </h3>
                  <p class="price-number">
                      <b>Price: <span>${book.price}₪</span></b>
                  </p>
                  <button class="add-book-button" data-book-id="${book.googleBooksId}">Add book</button>
              </div>`;
              
              container.append(bookCard);
          });
      }

      function fetchBooksFromDB(isEbook, pageNumber, pageSize) {
        console.log(pageSize);
        console.log("hi from fetch books from data base");
        const api = `https://localhost:7291/api/Books?isEbook=${isEbook}&pageNumber=${pageNumber}&pageSize=${pageSize}`;
        ajaxCall("GET", api, "", fetchBooksSuccess, fetchBooksError);
      }

      function fetchBooksSuccess(response) {
        console.log("Success response: ", response);

        const container = response.isEbook ? $('.main-container').first() : $('.main-container').last();
        const paginationElement = response.isEbook ? $('#digital-pagination') : $('#physical-pagination');
        renderBooks(response.books, container);
        updatePaginationControls(response.totalRecords, response.pageSize, response.pageNumber, paginationElement);
      }

      function fetchBooksError(err) {
        console.error("Error fetching books:", err);
      }

      // Function to update pagination controls
    function updatePaginationControls(totalRecords, pageSize, currentPage, paginationElement) {
        const totalPages = Math.ceil(totalRecords / pageSize);

        let paginationHtml = `
            <button class="prevPage" ${currentPage <= 1 ? 'disabled' : ''}>Previous</button>
            <span>Page ${currentPage} of ${totalPages}</span>
            <button class="nextPage" ${currentPage >= totalPages ? 'disabled' : ''}>Next</button>
        `;
        paginationElement.html(paginationHtml);

        // Event handlers for pagination buttons
        paginationElement.find('.prevPage').on('click', function () {
            if (currentPage > 1) {
                currentPage--;
                loadBooksBasedOnContainer(paginationElement, currentPage, pageSize);
            }
        });

        paginationElement.find('.nextPage').on('click', function () {
            if (currentPage < totalPages) {
                currentPage++;
                loadBooksBasedOnContainer(paginationElement, currentPage, pageSize);
            }
        });

        // Function to load books based on the container
      function loadBooksBasedOnContainer(paginationElement, page, pageSize) {
          if (paginationElement.is('#digital-pagination')) {
              loadDigitalBooks(page, pageSize);
          } else if (paginationElement.is('#physical-pagination')) {
              loadPhysicalBooks(page, pageSize);
          }
      }

      
    }
    </script>
    
    <script src="../Js/ajaxCalls.js"></script>
    <script src="../Js/headerJs.js"></script>
    <script src="../Js/indexJs.js"></script>
</body>
</html>